# React-union

**See [API reference](https://github.com/lundegaard/react-union/blob/master/packages/react-union/API.md).**

React-union is React component that allows assembling React application with just one virtual DOM from distributed HTML segments - **DOM-marks**.

_DOM-marks_ can be generated by a server technology that primarily does not support server-side rendering of JavaScript applications such as content management systems (_CMS_) - Wordpress, Drupal or Umbraco) or Portals (Liferay or Adobe Experience Manager).

## Content

* [Simple example](#simple-example)
* [Installation](#installation)
* [FAQ](#faq)
* [Reference](#reference)

## Simple example

**Output of server:**

```html
<main>
	<p>Static content produced by your favourite CMS.</p>


	<div id="hero-container"></div>


	<p>Another static content produced by your favourite CMS.</p>

	<!-- Union DOM-mark - configuration for your React widget  -->
	<!-- Probably rendered by a server  -->
	<script data-union-widget="" type="application/json">
	{
		"name": "hero",
		"container": "hero-container"
	}
	</script>
</main>
```

**One of your widgets:**

```js
// Hero.js

// Main component of your Hero widget
const Hero = () => 'I am Hero!';

// Route is a object that pairs DOM-mark with your widget
export const route = {
	path: 'hero',
	getComponent(done) {
		done(Hero);
	},
};

export default Hero;
```

**Main Root component:**

```js
// Root.js

import React from 'react';
import { Union } from 'react-union';

import { route } from './Hero';

// `Union` renders found widgets into their containers
// but retains single virtual DOM. Yes, it uses React portals :)

const Root = () => <Union routes={[route]} />;

export default Root;
```

# FAQ

## _Why should I use it?_

React-union makes features such as Hot Module Reloading possible for systems such as Wordpress or Liferay!

```jsx
// index.js
import React from 'react';
import { render } from 'react-dom';
import { AppContainer } from 'react-hot-loader';

import Root from './Root';

const renderComponent = Component =>
	render(
		<AppContainer>
			<Component />
		</AppContainer>,
		document.getElementById('root')
	);

renderComponent(Root);

if (module.hot) {
	module.hot.accept(['./Root'], () => {
		const NextRoot = require('./Root').default;
		renderComponent(NextRoot);
	});
}
```

## _Why single virtual DOM?_

**TL;DR;**: Redux :)

Your widgets might be distributed over the different parts of DOM. Your application, on the contrary, should use just one place for Application State (single source of truth).
For example in Redux, you should have one store to allow [time traveling](https://github.com/gaearon/redux-devtools#redux-devtools). Implementation in Union is pretty straightforward.

Your entry file can look like this:

```jsx
// index.js

import { justRender } from 'react-union';
import Root from './Root';

// ...

const store = configureStore();

// "justRender" creates HTML element for you app.
// Useful if you don't have root element prepared
// Never use just "document.body"!
justRender(<Root store={store} />);

export default Root;
```

... and your Root component like this:

```jsx
// Root.js

import { Provider } from 'redux';

// ...

const Root = ({ store }) => (
	<Provider store={store}>
		<Union routes={[route]} />
	</Provider>
);

export default Root;
```

... and that's it.

Now every widget can `connect` to your store. Multiple widgets... but the single state (time traveling everywhere!)!

## Installation

```sh
yarn add react-union
```

or

```sh
npm install --save react-union
```

And make sure you have React 16.0.0 or greater.

## Reference

* [API reference](https://github.com/lundegaard/react-union/blob/master/packages/react-union/API.md) - Work in progress
* [React-union-boilerplate-basic](https://github.com/lundegaard/react-union/tree/master/boilerplates/react-union-boilerplate-basic) - Example of project with React-union and React-union-scripts
